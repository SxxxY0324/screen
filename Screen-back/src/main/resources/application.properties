spring.application.name=Screen-back
server.port=8081
server.servlet.context-path=/

# SQL Server数据库配置 - 最大化兼容性和稳定性
# 使用明确端口和超长超时
spring.datasource.url=jdbc:sqlserver://192.168.0.63:1433;databaseName=CutDB03;encrypt=false;trustServerCertificate=true;loginTimeout=120;socketTimeout=120;selectMethod=cursor

# 备选配置选项（取消注释使用）：
# 本地SQL Server:
# spring.datasource.url=jdbc:sqlserver://localhost:1433;databaseName=CutDB03;encrypt=false;trustServerCertificate=true;sslProtocol=TLS;enabledSslProtocolSuites=TLSv1;loginTimeout=30;socketTimeout=30

# 其他常用内网地址:
# spring.datasource.url=jdbc:sqlserver://192.168.1.100:1433;databaseName=CutDB03;encrypt=false;trustServerCertificate=true;sslProtocol=TLS;enabledSslProtocolSuites=TLSv1;loginTimeout=30;socketTimeout=30
# 旧地址（已不可用）:
# spring.datasource.url=jdbc:sqlserver://192.168.163.203:1433;databaseName=CutDB03;encrypt=false;trustServerCertificate=true;sslProtocol=TLS;enabledSslProtocolSuites=TLSv1;loginTimeout=30;socketTimeout=30

spring.datasource.username=sa
spring.datasource.password=123456
spring.datasource.driver-class-name=com.microsoft.sqlserver.jdbc.SQLServerDriver

# 禁用DevTools自动重启和LiveReload功能
spring.devtools.restart.enabled=false
spring.devtools.livereload.enabled=false

# HikariCP连接池配置 - 优化超时设置
spring.datasource.hikari.connection-timeout=60000
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# 允许应用启动即使数据库连接失败（用于前端测试）
spring.sql.init.continue-on-error=true

# JPA配置 - 修改为不自动创建表，因为表已存在
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.SQLServer2012Dialect
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults=false
spring.jpa.properties.hibernate.format_sql=true
# 配置SQL Server的命名策略
spring.jpa.properties.hibernate.physical_naming_strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
# 禁用自动表验证避免DDL错误
spring.jpa.properties.hibernate.hbm2ddl.auto=none
spring.jpa.database-platform=org.hibernate.dialect.SQLServer2012Dialect

# JWT配置
jwt.secret=mySecretKey
# JWT访问令牌过期时间（毫秒），24小时
jwt.expiration=86400000
# JWT刷新令牌过期时间（毫秒），7天
jwt.refresh.expiration=${JWT_REFRESH_EXPIRATION:604800000}

# CORS配置(已在CorsConfig类中完成更详细配置)
# 这里的配置将被CorsConfig类中的配置覆盖
# spring.mvc.cors.allowed-origins=*
# spring.mvc.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
# spring.mvc.cors.allowed-headers=*
# spring.mvc.cors.allow-credentials=true
# spring.mvc.cors.max-age=3600

spring.mvc.contentnegotiation.defaultContentType=application/json
spring.mvc.converters.preferred-json-mapper=jackson

# 微信小程序配置
wechat.app-id=${WECHAT_APP_ID:wx234a340a08a26521}
wechat.app-secret=${WECHAT_APP_SECRET:24006f34681df4f0e5300709b44d3e04}
wechat.login-url=https://api.weixin.qq.com/sns/jscode2session
wechat.phone-number-url=https://api.weixin.qq.com/wxa/business/getuserphonenumber

# 日志配置 - 只抑制TLS相关的WARN日志，不影响数据库连接
logging.level.com.microsoft.sqlserver.jdbc.internals.TDS.Channel=ERROR
logging.level.com.jwsxy.screenback=DEBUG
logging.level.com.jwsxy=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
